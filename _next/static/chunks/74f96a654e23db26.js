(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,45347,e=>{"use strict";var t=e.i(43476),a=e.i(71645),l=e.i(57688);function r(){let e=(0,a.useRef)(null),r=(0,a.useRef)(null),[s,n]=(0,a.useState)(null),[i,o]=(0,a.useState)(null),[c,d]=(0,a.useState)(!1),[m,p]=(0,a.useState)(null);return(0,a.useEffect)(()=>{{let e=window.localStorage.getItem("adoptedPlanet");if(e)try{n(JSON.parse(e))}catch{n(null)}}return async function(){try{let t=await navigator.mediaDevices.getUserMedia({video:{width:1280,height:720},audio:!1});e.current&&(e.current.srcObject=t,e.current.onloadedmetadata=()=>{e.current?.play(),d(!0)})}catch(e){console.error("Camera error:",e),p("Could not access your camera. Please check browser permissions.")}}(),()=>{e.current&&e.current.srcObject&&e.current.srcObject.getTracks().forEach(e=>e.stop())}},[]),(0,t.jsxs)("div",{className:"page",children:[(0,t.jsx)("h1",{className:"page-title",children:"Mission Polaroid"}),(0,t.jsx)("p",{className:"page-subtitle",children:"Like the humans on the Axiom taking photos, snap a mission picture with your learned/adopted planet after your cleanup bot has made its orbit safe."}),(0,t.jsxs)("div",{className:"card",style:{marginBottom:"1.2rem"},children:[(0,t.jsxs)("div",{className:"badge",children:[(0,t.jsx)("span",{children:"ðŸ“·"}),(0,t.jsx)("span",{children:"Mission Photo"})]}),s?(0,t.jsxs)("p",{style:{fontSize:"0.9rem",marginTop:"0.7rem"},children:["You're the guardian of ",(0,t.jsx)("strong",{children:s.name}),". Take your official mission photo to celebrate a safer orbit."]}):(0,t.jsx)("p",{style:{fontSize:"0.9rem",marginTop:"0.7rem"},children:"No adopted planet found. You can still try the camera, or go back to the Adopt page to pick a world and clean its orbit."}),m&&(0,t.jsx)("p",{style:{color:"#fecaca",fontSize:"0.86rem"},children:m}),(0,t.jsxs)("div",{style:{marginTop:"1rem",display:i?"none":"flex",flexDirection:"column",alignItems:"center",gap:"0.8rem"},children:[(0,t.jsxs)("div",{className:"video-frame",children:[(0,t.jsx)("video",{ref:e,autoPlay:!0,playsInline:!0,className:"video-element"}),(0,t.jsx)("div",{className:"planet-overlay",children:(0,t.jsx)("img",{src:s?.imageUrl||"/planet-fallback.png",alt:s?.name||"Planet"})})]}),(0,t.jsx)("button",{className:"btn",onClick:()=>{if(!e.current||!r.current)return;let t=e.current,a=r.current,l=a.getContext("2d");if(!l)return;let n=t.videoWidth||1280,i=t.videoHeight||720;a.width=n,a.height=i,l.drawImage(t,0,0,n,i);let c=new window.Image;c.crossOrigin="anonymous",c.src=s?.imageUrl||"/planet-fallback.png",c.onload=()=>{let e=.22*n,t=n-e-40,r=i-e-40;l.save(),l.beginPath(),l.arc(t+e/2,r+e/2,e/2,0,2*Math.PI),l.closePath(),l.clip(),l.drawImage(c,t,r,e,e),l.restore();let d=s?.name||"Your Planet";l.font="32px system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI'",l.fillStyle="#ffffff",l.strokeStyle="rgba(15,23,42,0.9)",l.lineWidth=4;let m=`Guardian of ${d}`,p="Planet Learned and Orbit Stabilized";l.strokeText(m,42,60),l.fillText(m,42,60),l.font="22px system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI'",l.strokeText(p,42,100),l.fillText(p,42,100),o(a.toDataURL("image/png"))}},disabled:!c,children:c?"ðŸ“¸ Take Mission Photo":"Loading cameraâ€¦"})]}),(0,t.jsx)("canvas",{ref:r,style:{display:"none"}}),i&&(0,t.jsxs)("div",{style:{marginTop:"1rem",display:"flex",flexDirection:"column",alignItems:"center",gap:"0.9rem"},children:[(0,t.jsx)("img",{src:i,alt:"Mission photo",className:"photo-preview"}),(0,t.jsxs)("div",{style:{display:"flex",gap:"0.6rem",flexWrap:"wrap"},children:[(0,t.jsx)("button",{className:"btn",onClick:()=>{if(!i)return;let e=document.createElement("a");e.href=i;let t=(s?.name||"planet").toLowerCase().replace(/\s+/g,"_");e.download=`mission_guardian_${t}.png`,e.click()},children:"â¬‡ï¸ Download Photo"}),(0,t.jsx)("button",{className:"btn btn-secondary",onClick:()=>{o(null)},children:"ðŸ” Retake"})]}),(0,t.jsxs)("div",{style:{display:"flex",gap:"0.75rem",alignItems:"center",marginTop:"0.4rem"},children:[(0,t.jsx)(l.default,{src:"/walle.png",alt:"Cleanup bot",width:70,height:80}),(0,t.jsx)("span",{style:{fontSize:"0.85rem"},children:"Mission complete! Your orbit is clean â€“ directive fulfilled."})]})]})]})]})}e.s(["default",()=>r])}]);